!function(a,b){"function"==typeof define&&define.amd?define(function(){return b(a)}):"object"==typeof exports?module.exports=b:a.echo=b(a)}(this,function(a){"use strict";var b,c,d,e,f,g={},h=function(){},i=function(a){return null===a.offsetParent},j=function(a,b){if(i(a))return!1;var c=a.getBoundingClientRect();return c.right>=b.l&&c.bottom>=b.t&&c.left<=b.r&&c.top<=b.b},k=function(){!e&&c||(clearTimeout(c),c=setTimeout(function(){g.render(),c=null},d))};return g.init=function(c){c=c||{};var i=document.getElementById("lazyLoad")||a,j=c.offset||0,l=c.offsetVertical||j,m=c.offsetHorizontal||j,n=function(a,b){return parseInt(a||b,10)};b={t:n(c.offsetTop,l),b:n(c.offsetBottom,l),l:n(c.offsetLeft,m),r:n(c.offsetRight,m)},d=n(c.throttle,250),e=c.debounce!==!1,f=!!c.unload,h=c.callback||h,g.render(),document.addEventListener?(a.addEventListener("scroll",k,!1),a.addEventListener("load",k,!1),i.addEventListener("scroll",k,!1),i.addEventListener("load",k,!1)):(a.attachEvent("onscroll",k),a.attachEvent("onload",k),i.addEventListener("onscroll",k,!1),i.addEventListener("onload",k,!1))},g.render=function(){for(var c,d,e=document.querySelectorAll("img[data-echo], [data-echo-background]"),i=e.length,k={l:0-b.l,t:0-b.t,b:(a.innerHeight||document.documentElement.clientHeight)+b.b,r:(a.innerWidth||document.documentElement.clientWidth)+b.r},l=0;i>l;l++)d=e[l],j(d,k)?(f&&d.setAttribute("data-echo-placeholder",d.src),null!==d.getAttribute("data-echo-background")?d.style.backgroundImage="url("+d.getAttribute("data-echo-background")+")":d.src=d.getAttribute("data-echo"),f||(d.removeAttribute("data-echo"),d.removeAttribute("data-echo-background")),h(d,"load")):f&&(c=d.getAttribute("data-echo-placeholder"))&&(null!==d.getAttribute("data-echo-background")?d.style.backgroundImage="url("+c+")":d.src=c,d.removeAttribute("data-echo-placeholder"),h(d,"unload"));i||g.detach()},g.detach=function(){document.removeEventListener?a.removeEventListener("scroll",k):a.detachEvent("onscroll",k),clearTimeout(c)},g});